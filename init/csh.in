#!/bin/csh
setenv LMOD_CMD "@PKG@/libexec/lmod"
setenv LMOD_DIR "@PKG@/libexec"
setenv LMOD_PKG "@PKG@"

set prefix  = ""
set midfix  = ""
set postfix = ";"

set histchar = \!
if ( $?histchars) then
  set histchar   = `echo $histchars | cut -c1`
  if ( "$histchar" != '\!' ) then
    set _histchars = $histchars
    set prefix  = 'set _histchars = $histchars; unset histchars;'
    set midfix  = '--localvar histchars=$_histchars'
    set postfix = ';set histchars = $_histchars'
  endif
endif

alias modulelogger 'if ( "\!*" =~ "load ?*" ) "$FASRCSW_PROD"/modulehook/modulelogger -s cli -a load -u "$USER" \!*; endif'

if ($?tcsh) then
  alias __module  $prefix'unsetenv _MODULE_LOAD_SUCCESS; eval `$LMOD_CMD csh '$midfix $histchar'*` && setenv _MODULE_LOAD_SUCCESS '$postfix' eval `$LMOD_SETTARG_CMD -s csh`'
else
  alias __module  $prefix'unsetenv _MODULE_LOAD_SUCCESS; eval `$LMOD_CMD csh '$midfix $histchar'*` && setenv _MODULE_LOAD_SUCCESS '$postfix
endif

alias module '__module \!*; eval `if ($?_MODULE_LOAD_SUCCESS) echo modulelogger \!*`'

alias clearMT 'eval `'$LMOD_DIR/clearMT_cmd csh'`'

alias ml      'eval `'$LMOD_DIR/ml_cmd' '$histchar'*`'

unset prefix
unset midfix
unset postfix
unset histchar


if ( $?prompt && $?tcsh && "$LMOD_FULL_SETTARG_SUPPORT" != no ) then
   alias cwdcmd 'eval `$LMOD_SETTARG_CMD -s csh`'

   switch ($TERM)
      case "xterm*":
         set echo_style=both
         alias precmd 'echo -n "\033]2;${TARG_TITLE_BAR_PAREN}${HOST}:$cwd\007"'
         breaksw
      endsw
   endif
endif
# Local Variables:
# mode: shell-script
# end:

